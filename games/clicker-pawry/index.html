<!DOCTYPE html><html lang="en"><meta charset="utf-8"><meta content="width=device-width,initial-scale=1" name="viewport"><title>Clicker Pawry</title><meta content="A black cat clicker roguelite with parry timing mechanics." name="description"><meta content="#111111" name="theme-color"><style>@keyframes cd{0%{background-position:0 0,50px 50px}to{background-position:100px 100px,150px 150px}}:root{--bg:#050505;--p1:#4a5a8a;--p2:#3a4f7a;--accent:#39a8ff;--accent2:#e34a4a}body,html{height:100%}*,body{font-family:Arial,"Helvetica Neue",Helvetica,sans-serif}body{margin:0;color:#fff;background:repeating-conic-gradient(var(--p1) 0 25%,var(--p2) 25% 50%) 0 0/100px 100px,repeating-conic-gradient(var(--p2) 0 25%,var(--p1) 25% 50%) 50px 50px/100px 100px;animation:cd 25s linear infinite}#cv{display:block;max-width:100vw;max-height:100vh}.start-screen{position:fixed;inset:0;z-index:10;display:grid;place-items:center;color:#111;background:0 0}.start-card{background:rgba(17,17,17,.9);color:#fff;padding:24px 20px;border-radius:12px;box-shadow:0 8px 24px rgba(0,0,0,.35);width:min(92vw,420px);text-align:center;border:1px solid rgba(255,255,255,.08)}.title{margin:0 0 6px;font-size:1.6rem;letter-spacing:.5px}.tagline{margin:0 0 16px;color:#cfd8e3;font-size:.95rem}.record-display{background:rgba(255,215,0,.1);border:1px solid gold;border-radius:8px;padding:8px 16px;margin-bottom:20px;text-align:center;display:flex;align-items:center;justify-content:center;gap:8px}.record-label,.record-value{color:gold;font-size:14px;font-weight:700}.record-value{color:#fff;font-size:16px}.btns{display:grid;gap:10px;margin-top:8px}button.btn{appearance:none;border:0;border-radius:10px;padding:12px 14px;font-size:1rem;font-weight:600;cursor:pointer;color:#dedede;background:var(--p1);transition:transform 60ms ease,box-shadow .2s ease,background .3s ease;box-shadow:0 2px 0 rgba(0,0,0,.4)}button.btn:hover{transform:translateY(-1px)}button.btn:active{transform:translateY(0);box-shadow:none}button.btn.alt{background:var(--p2)}button.btn.secondary{background:#555;color:#fff}button.btn.danger{background:var(--accent2);color:#fff}button.btn[disabled]{opacity:.5;cursor:not-allowed}.modal{position:fixed;inset:0;z-index:20;background:rgba(0,0,0,.8);display:flex;align-items:center;justify-content:center;backdrop-filter:blur(4px)}.modal-content{background:rgba(17,17,17,.95);color:#fff;padding:0;border-radius:12px;box-shadow:0 12px 32px rgba(0,0,0,.5);width:min(90vw,500px);max-height:80vh;overflow-y:auto;border:1px solid rgba(255,255,255,.1)}.modal-header{display:flex;justify-content:space-between;align-items:center;padding:20px 24px 16px;border-bottom:1px solid rgba(255,255,255,.1)}.modal-header h2{margin:0;font-size:1.4rem;color:var(--accent)}.close-btn{background:0 0;border:0;color:#ccc;font-size:24px;cursor:pointer;padding:4px 8px;border-radius:4px;transition:background .2s ease}.close-btn:hover{background:rgba(255,255,255,.1);color:#fff}.modal-body{padding:20px 24px 24px}.howto-section{margin-bottom:20px}.howto-section:last-child{margin-bottom:0}.howto-section h3{margin:0 0 8px;font-size:1.1rem;color:var(--accent)}.howto-section p{margin:4px 0;line-height:1.4;color:#e0e0e0}.howto-section p strong{color:#fff}.game-container{width:100%;height:100vh;background:repeating-conic-gradient(var(--p1) 0 25%,var(--p2) 25% 50%) 0 0/100px 100px,repeating-conic-gradient(var(--p2) 0 25%,var(--p1) 25% 50%) 50px 50px/100px 100px;animation:cd 25s linear infinite;display:flex;justify-content:center;align-items:stretch;position:fixed;top:0;left:0;z-index:999;padding:0}.game-container canvas{width:100%;height:100%}</style><div class="start-screen" id="start" aria-labelledby="t" aria-modal="true" role="dialog"><div class="start-card"><h1 class="title" id="t">Clicker Pawry</h1><p class="tagline">A Black Cat Clicker Roguelite with Parry Timing<div class="record-display" id="record-display" style="display:none"><span class="record-label">Best Record:</span> <span class="record-value" id="record-value">Floor 0</span></div><div class="btns"><button class="btn" id="btn-new">New Run</button> <button class="btn secondary" id="btn-howto">How To Play</button> <button class="btn danger" id="btn-clear">Clear Data</button></div></div></div><div class="modal" id="howto-modal" style="display:none"><div class="modal-content"><div class="modal-header"><h2>How To Play</h2><button class="close-btn" id="close-howto">√ó</button></div><div class="modal-body"><div class="howto-section"><h3>üéØ Controls</h3><p><strong>Tap/Click on ring:</strong> Parry incoming attacks<p><strong>Berserk Mode:</strong> Spam click the central button, you are immune to damage.</div><div class="howto-section"><h3>‚öîÔ∏è Combat</h3><p><strong>White rings:</strong> Normal attacks - parry to avoid damage<p><strong>Red rings:</strong> Heavy attacks - damage x2<p><strong>Perfect Parry:</strong> Deal 2√ó damage and avoid damage<p><strong>Good Parry:</strong> Block the attack but deal normal damage</div><div class="howto-section"><h3>üèÜ Goal</h3><p>Beat 12 floors of bosses to reach the endless mode. Spend gold on permanent upgrades to get stronger!</div></div></div></div><div class="game-container" id="game-container" style="display:none"><canvas id="cv"></canvas></div><noscript>Please enable JavaScript to play.</noscript><script>"undefined"!=typeof window&&(window.ClickerPawryConstants={FONT_SCALE:1.2,PLAYER_BASE_STATS:{MAX_HP:9,MAX_STAMINA:100,BASE_STAMINA_REGEN:10,BASE_DAMAGE:1},DRAFT_OPTIONS:{HEAL:{name:"Heal",description:"Restore 2 hearts",effect:"heal"},GOLD:{name:"Bonus Gold",description:"Gain 20 extra gold",effect:"gold"}},SAVE_KEYS:{PERSISTENT_DATA:"js13k25_clickerpawry",RUN_DATA:"js13k25_clickerpawry_run"},META_UPGRADES:{MAX_STAMINA:{name:"Max Stamina",description:"+20 max stamina per level",maxLevel:5,costs:[60,120,200,300,440],effect:e=>20*e},STAMINA_REGEN:{name:"Stamina Regen",description:"+2/s stamina regen per level",maxLevel:5,costs:[60,120,200,300,440],effect:e=>2*e},ATTACK_POWER:{name:"Attack Power",description:"+1 per level",maxLevel:5,costs:[80,140,220,320,460],effect:e=>1*e}},RING_TYPES:{WHITE:"W",BLUE:"B",RED:"R"},PARRY_WINDOWS:{PERFECT:80,GOOD:160},ENEMY_ARCHETYPES:{A:{name:"Mice",patterns:{white:.7,red:.3},interval:800,ringDurations:{white:950,red:1e3}},C:{name:"Dog",patterns:{white:.8,red:.2},interval:1e3,ringDurations:{white:850,red:800}}},RING_DAMAGE:{MINIBOSS:{W:1,B:0,R:1},MAJOR:{W:1,B:0,R:1}},ENEMY_BASE_HP:[0,12,14,25,18,20,40,26,28,60,34,36,85],GAME_STATES:{LOBBY:"lobby",DRAFT:"draft",FIGHT:"fight",VICTORY:"victory",DEFEAT:"defeat",ENDLESS:"endless"}})</script><script>!function(){const e="js13k25_clickerpawry",t=document.getElementById("start"),o=document.getElementById("btn-new"),n=document.getElementById("btn-howto"),l=document.getElementById("btn-clear"),d=document.getElementById("howto-modal"),a=document.getElementById("close-howto"),c=document.getElementById("record-display"),s=document.getElementById("record-value");function r(){try{const t=localStorage.getItem(e);if(console.log("Loading record from localStorage:",e,t),t){const e=JSON.parse(t),o=e.highestFloor||0;console.log("Parsed data:",e,"highestFloor:",o),o>0?(s.textContent=`Floor ${o}`,c.style.display="flex",console.log("Record displayed:",o)):(c.style.display="none",console.log("No record to display"))}else c.style.display="none",console.log("No persistent data found")}catch(e){console.warn("Could not load record:",e),c.style.display="none"}}function i(e){e.style.display="none",e.setAttribute("aria-hidden","true")}r(),window.updateRecordDisplay=r,o.addEventListener("click",()=>function(){t.style.display="none";const e=document.getElementById("game-container");e&&(e.style.display="flex");const o=document.getElementById("cv");o&&o.focus&&o.focus()}()),n.addEventListener("click",()=>{return(e=d).style.display="flex",void e.setAttribute("aria-hidden","false");var e}),a.addEventListener("click",()=>i(d)),d.addEventListener("click",e=>{e.target===d&&i(d)}),l.addEventListener("click",()=>{confirm("‚ö†Ô∏è Are you sure you want to delete all your save data? This action is irreversible!")&&(Object.keys(localStorage).forEach(e=>{e.startsWith("js13k25_clickerpawry")&&localStorage.removeItem(e)}),alert("‚úÖ Data deleted successfully!"),window.location.reload())}),document.addEventListener("keydown",e=>{"Escape"===e.key&&"flex"===d.style.display&&i(d)})}()</script><script>let g=null,c=null,ctx=null,h=0;const assets={h:new Image,s:new Image,l:!1},constants=window.ClickerPawryConstants;function l(){c=document.getElementById("cv"),ctx=c.getContext("2d"),r(),function(){let t=0;function s(){t++,2===t&&(assets.l=!0)}assets.h.onload=s,assets.s.onload=s,assets.h.src="catHappy.png",assets.s.src="catHappy.png"}(),g=new GE,g.sg(),requestAnimationFrame(m)}function r(){let t=Math.min(window.innerWidth,400),s=window.innerHeight-40;t>400&&(t=400),c.width=t,c.height=s,c.style.width=t+"px",c.style.height=s+"px",c.style.display="block",c.style.margin="20px auto 0",ctx.imageSmoothingEnabled=!1}function a(t,s="normal"){const i=Math.round(t*constants.FONT_SCALE);return"bold"===s?`bold ${i}px Arial`:`${i}px Arial`}class f{constructor(){this.hp=constants.PLAYER_BASE_STATS.MAX_HP,this.mh=constants.PLAYER_BASE_STATS.MAX_HP,this.st=constants.PLAYER_BASE_STATS.MAX_STAMINA,this.ms=constants.PLAYER_BASE_STATS.MAX_STAMINA,this.sr=constants.PLAYER_BASE_STATS.BASE_STAMINA_REGEN,this.bd=constants.PLAYER_BASE_STATS.BASE_DAMAGE,this.g=0,this.hf=0,this.mu={MAX_STAMINA:0,STAMINA_REGEN:0,ATTACK_POWER:0},this.cf=1,this.sk=[],this.pp=0,this.ru=0,this.lsu=Date.now(),this.set=0,this.lfls()}snr(){this.ms=this.gms(),this.sr=this.gsr(),this.bd=this.gbd(),this.hp=this.mh,this.st=this.ms,this.cf=1,this.sk=[],this.pp=0,this.ru=0,this.lsu=Date.now(),this.set=0,this.srs()}amu(){this.ms=this.gms(),this.sr=this.gsr(),this.bd=this.gbd(),this.st>this.ms&&(this.st=this.ms)}u(t){const s=Date.now(),i=s-this.lsu;if(this.lsu=s,this.st<=0&&0===this.set&&(this.set=s),this.st<this.ms){const t=750;if(0===this.set||s-this.set>t){const t=this.sr*i/1e3;this.st=Math.min(this.ms,this.st+t),this.set>0&&(this.set=0)}}}ca(){return this.st>=1}a(){return this.ca()?(this.st=Math.max(0,this.st-1),this.bd):0}td(t,s=null){return this.hp=Math.max(0,this.hp-t),s&&t>0&&s.tde(),this.hp<=0}h(t){this.hp=Math.min(this.mh,this.hp+t)}ag(t){this.g+=t,this.stls()}gms(){return constants.PLAYER_BASE_STATS.MAX_STAMINA+constants.META_UPGRADES.MAX_STAMINA.effect(this.mu.MAX_STAMINA)}gsr(){return constants.PLAYER_BASE_STATS.BASE_STAMINA_REGEN+constants.META_UPGRADES.STAMINA_REGEN.effect(this.mu.STAMINA_REGEN)}gbd(){return constants.PLAYER_BASE_STATS.BASE_DAMAGE+constants.META_UPGRADES.ATTACK_POWER.effect(this.mu.ATTACK_POWER)}cau(t){const s=constants.META_UPGRADES[t],i=this.mu[t];if(i>=s.maxLevel)return!1;const h=s.costs[i];return this.g>=h}bu(t){if(!this.cau(t))return!1;const s=constants.META_UPGRADES[t],i=this.mu[t],h=s.costs[i];return this.g-=h,this.mu[t]++,this.ms=this.gms(),this.sr=this.gsr(),this.bd=this.gbd(),this.stls(),!0}stls(){try{const t={gold:this.g,metaUpgrades:this.mu,highestFloor:this.hf||0};localStorage.setItem(constants.SAVE_KEYS.PERSISTENT_DATA,JSON.stringify(t))}catch(t){}}srs(){try{const t={currentFloor:this.cf,hp:this.hp,stamina:this.st,skills:this.sk,perfectParries:this.pp,rerollsUsed:this.ru};localStorage.setItem(constants.SAVE_KEYS.RUN_DATA,JSON.stringify(t))}catch(t){}}lfls(){try{const t=localStorage.getItem(constants.SAVE_KEYS.PERSISTENT_DATA);if(t){const s=JSON.parse(t);return this.g=s.gold||0,this.hf=s.highestFloor||0,this.mu={...this.mu,...s.metaUpgrades},this.amu(),!0}}catch(t){}return!1}lrs(){try{const t=localStorage.getItem(constants.SAVE_KEYS.RUN_DATA);if(t){const s=JSON.parse(t);return this.cf=s.currentFloor||1,this.hp=s.hp||this.mh,this.st=s.stamina||this.ms,this.sk=s.skills||[],this.pp=s.perfectParries||0,this.ru=s.rerollsUsed||0,!0}}catch(t){}return!1}}class o{constructor(t,s){this.x=t,this.y=s,this.l=400,this.ml=400,this.s=0,this.ms=2}u(t){this.l-=t;const s=1-this.l/this.ml;if(s<.3)this.s=s/.3*this.ms;else{const t=(s-.3)/.7;this.s=this.ms*(1-t)}return this.l>0}d(t){if(this.s<=0)return;const s=Math.max(0,this.l/this.ml);t.save(),t.globalAlpha=s,t.translate(this.x,this.y),t.scale(this.s,this.s),this.dp(t),t.restore()}dp(t){t.fillStyle="#000",t.strokeStyle="#333",t.lineWidth=1,t.beginPath(),t.ellipse(0,0,12,8,0,0,2*Math.PI),t.fill(),t.stroke(),[{x:-8,y:-10},{x:-3,y:-12},{x:3,y:-12},{x:8,y:-10}].forEach(s=>{t.beginPath(),t.arc(s.x,s.y,3,0,2*Math.PI),t.fill(),t.stroke()})}}class PT{constructor(t,s,i,h,e,c){this.x=t,this.y=s,this.c=i,this.v=h,this.s=e,this.l=c,this.ml=c,this.g=.1}u(t){return this.x+=this.v.x*t/16,this.y+=this.v.y*t/16,this.v.y+=this.g,this.l-=t,this.l/this.ml>0}d(t){const s=Math.max(0,this.l/this.ml);t.save(),t.globalAlpha=s,t.fillStyle=this.c,t.beginPath(),t.arc(this.x,this.y,this.s,0,2*Math.PI),t.fill(),t.restore()}}class d{constructor(t,s,i,h=60,e=30){this.t=t,this.st=s,this.d=i,this.sr=h,this.tr=e,this.ia=!0,this.hi=!1,this.x=0,this.y=0}gp(t){return Math.min(1,(t-this.st)/this.d)}gcr(t){const s=this.gp(t);return this.sr-(this.sr-this.tr)*s}hrt(t){return this.gp(t)>=1}gpt(t,s=1){const i=this.st+this.d-t,h=Math.abs(i),e=constants.PARRY_WINDOWS.PERFECT*s,c=constants.PARRY_WINDOWS.GOOD*s;return h<=e?"perfect":h<=c?"good":"miss"}ici(t,s,i){const h=this.gcr(i);return Math.sqrt((t-this.x)**2+(s-this.y)**2)<=h}}class p{constructor(){this.cs="lobby",this.p=null,this.ce=null,this.r=[],this.dc=[],this.lat=0,this.nrt=0,this.bm=!1,this.bd=0}tt(t){this.cs=t,"draft"===t?this.gdc():"fight"===t&&this.cef()}gdc(){this.dc=[],this.dc.push({option:constants.DRAFT_OPTIONS.HEAL,type:"heal"}),this.dc.push({option:constants.DRAFT_OPTIONS.GOLD,type:"gold"})}sdc(t){if(t>=0&&t<this.dc.length){switch(this.dc[t].type){case"heal":this.p.h(2);break;case"gold":this.p.ag(20)}this.eem?(this.cef(),this.tt("endless")):this.tt("fight")}}cef(){const t=this.p.cf;let s=20*Math.pow(1.15,t-1);const i=this.gaf(t);this.ce={hp:Math.floor(s),maxHp:Math.floor(s),archetype:i,archetypeData:constants.ENEMY_ARCHETYPES[i],damageFlashUntil:0},this.r=[],this.lat=0,this.nrt=Date.now()+1e3}gaf(t){const s=Object.keys(constants.ENEMY_ARCHETYPES);return s[Math.floor(Math.random()*s.length)]}hc(t,s,i){if(!this.ce||this.ce.hp<=0)return null;const h=this.ap(i,t,s);if(h){let t=this.p.bd;return"perfect"===h.timing&&(this.p.pp++,t=2*this.p.bd),t=Math.ceil(t),this.ce.hp=Math.max(0,this.ce.hp-t),this.ce.damageFlashUntil=i+200,this.ce.hp<=0&&this.hv(),{parry:h,damage:t}}}hv(){const t=this.cgr();this.lgr=t,this.p.ag(t),this.p.cf>this.p.hf&&(this.p.hf=this.p.cf,window.updateRecordDisplay&&window.updateRecordDisplay()),this.p.cf++,this.p.srs(),13===this.p.cf&&(this.eem=!0),this.tt("victory")}hd(){this.rf=this.p.cf,this.p.hp=this.p.mh,this.p.cf=1,this.p.pp=0,this.tt("defeat")}ap(t,s,i){let h=[];for(const e of this.r)if(e.ia&&e.ici(s,i,t)){const s=assets.st+e.d-t,i=Math.abs(s);h.push({ring:e,absTime:i,spawnTime:assets.st})}if(0===h.length)return null;h.sort((t,s)=>Math.abs(t.absTime-s.absTime)<100?t.spawnTime-s.spawnTime:t.absTime-s.absTime);const e=h[0].ring,c=e.gpt(t,1);return e.ia=!1,this.ge&&this.ge.crp(e.x,e.y,e.t,"miss"!==c),"miss"!==c?{ring:e,timing:c}:null}cbp(t){return!1}cgr(){let t=Math.floor(10+2*this.p.cf+5*Math.random())+Math.min(5,this.p.pp);if(this.p.cf>13){const s=this.p.cf-13;t=Math.floor(t*(1+.1*s))}return t}u(t){this.p&&this.p.u(t),("fight"===this.cs||"endless"===this.cs)&&this.ce&&this.ce.hp>0&&this.uc()}uc(){const t=Date.now();this.ubm(),this.ur(t),this.gr(t)}ubm(){if(this.bm){const t=.8;this.p.st=Math.max(0,this.p.st-t),this.p.st<=0&&(this.bm=!1)}}cub(){return!this.bm&&this.p.st>=this.p.ms}ab(){return!!this.cub()&&(this.bm=!0,!0)}ur(t){for(let s=this.r.length-1;s>=0;s--){const i=this.r[s];i.ia?(i.hrt(t)&&!i.hi&&(i.hi=!0,this.hri(i)),t-i.st>i.d+1e3&&this.r.splice(s,1)):this.r.splice(s,1)}}hri(t){if(this.ge&&this.ge.crp(t.x,t.y,t.t,!1),this.bm)return;let s=constants.RING_DAMAGE.MAJOR[t.t];this.p.td(s,this.ge)&&this.hd()}gsp(t){const s=c.width||400,i=c.height||600;for(let h=0;h<50;h++){const h=40+Math.random()*(s-80),e=130+Math.random()*(i-90-80-80);let c=!1;for(const t of this.r)if(t.ia&&Math.sqrt((h-t.x)**2+(e-t.y)**2)<80){c=!0;break}if(!c)return t.x=h,void(t.y=e)}t.x=40+Math.random()*(s-80),t.y=130+Math.random()*(i-90-80-80)}gr(t){if(t<this.nrt)return;const s=this.ce.archetypeData;switch(this.ce.archetype){case"A":case"C":this.gcr(t,s)}}gcr(t,s){const i=this.srt(s.patterns),h=this.grd(i,s),e=new d(i,t,h);this.gsp(e),this.r.push(e);let c=s.interval;c*=Math.max(.5,1-.05*(this.p.cf-1)),this.nrt=t+c}srt(t){return Math.random()<t.white?constants.RING_TYPES.WHITE:constants.RING_TYPES.RED}grd(t,s){let i=s.ringDurations[t.toLowerCase()]||1300;return i*=Math.max(.6,1-.04*(this.p.cf-1)),i}}class GE{constructor(){this.p=new f,this.gs=new p,this.gs.p=this.p,this.gs.ge=this,this.fm=[],this.ss={x:0,y:0,d:0},this.rf={a:0,d:0},this.cdt=0,this.pt=[],this.pe=[],this.ei={},this.lei(),this.sih(),this.sr={lobby:this.rl.bind(this),draft:this.rd.bind(this),fight:this.renderFight.bind(this),victory:this.rv.bind(this),defeat:this.rdf.bind(this),endless:this.renderFight.bind(this)}}lei(){Object.entries({A:"miceEnemy.png",C:"dogEnemy.png"}).forEach(([t,s])=>{const i=new Image;i.onload=()=>{this.ei[t]=i},i.src=s})}sg(){const t=this.p.lfls(),s=this.p.lrs();t||s||this.p.snr(),this.gs.tt("lobby")}sih(){c.addEventListener("pointerdown",t=>{t.preventDefault();const s=c.getBoundingClientRect(),i=t.clientX-s.left,h=t.clientY-s.top;this.hi(i,h)}),c.addEventListener("mousemove",t=>{const s=c.getBoundingClientRect(),i=t.clientX-s.left,h=t.clientY-s.top;this.hmm(i,h)}),window.addEventListener("keydown",t=>{this.hki(t.key)})}hi(t,s){const i=Date.now();switch(this.gs.cs){case"lobby":this.hli(t,s);break;case"draft":this.hdi(t,s);break;case"fight":case"endless":this.hfi(t,s,i);break;case"victory":this.gs.tt("draft");break;case"defeat":this.gs.tt("lobby")}}hki(t){switch(t){case"Escape":"fight"===this.gs.cs&&this.gs.tt("lobby");break;case"1":case"2":if("draft"===this.gs.cs){const s=parseInt(t)-1;this.gs.sdc(s)}}}hmm(t,s){}u(t){this.gs.u(t),this.ufm(t),this.ude(t),this.hr()}afm(t,s,i){this.fm.push({text:t,x:s,y:i,startTime:Date.now(),duration:1e3})}tde(){this.ss={x:8*(Math.random()-.5),y:8*(Math.random()-.5),duration:200},this.rf={a:.15,d:200},this.cdt=1e3}ufm(t){const s=Date.now();this.fm=this.fm.filter(t=>s-t.startTime<t.duration)}ude(t){this.ss.d>0&&(this.ss.d-=t,this.ss.d<=0&&(this.ss.x=0,this.ss.y=0)),this.rf.d>0&&(this.rf.d-=t,this.rf.a=Math.max(0,this.rf.d/200*.15)),this.cdt>0&&(this.cdt-=t),this.upt(t),this.upe(t)}upt(t){for(let s=this.pt.length-1;s>=0;s--)this.pt[s].u(t)||this.pt.splice(s,1)}crp(t,s,i,h){const e=h?12:8,c=this.grc(i),l=h?[`${c}`,"#fff","#ff0"]:["#f00","#f44","#a00"];for(let i=0;i<e;i++){const c=2*Math.PI*i/e+.3*Math.random(),n=h?3+2*Math.random():2+1.5*Math.random(),a={x:Math.cos(c)*n,y:Math.sin(c)*n-2*Math.random()},r=l[Math.floor(Math.random()*l.length)],o=h?2+2*Math.random():1.5+1.5*Math.random(),f=h?800+400*Math.random():600+300*Math.random();this.pt.push(new PT(t,s,r,a,o,f))}}grc(t){switch(t){case constants.RING_TYPES.WHITE:return"#fff";case constants.RING_TYPES.RED:return"#e34a4a";default:return"#fff"}}upe(t){for(let s=this.pe.length-1;s>=0;s--)this.pe[s].u(t)||this.pe.splice(s,1)}cpe(t,s){this.pe.push(new o(t,s))}hr(){this.rt||(this.rt=setTimeout(()=>{r(),this.rt=null},100))}r(){ctx.clearRect(0,0,c.width,c.height),ctx.save(),this.ss.d>0&&ctx.translate(this.ss.x,this.ss.y);const t=this.sr[this.gs.cs];t&&t(),ctx.restore(),this.rf.a>0&&(ctx.fillStyle=`rgba(255,0,0,${this.rf.a})`,ctx.fillRect(0,0,c.width,c.height))}rl(){this.dt("LOBBY"),this.dps(),this.dmu(),this.dsb()}rd(){this.dt(`FLOOR ${this.p.cf}/12`),this.p.cf>=13&&(ctx.fillStyle="#FFD700",ctx.font=a(18,"bold"),ctx.textAlign="center",ctx.fillText("üéâEndless",c.width/2,70)),this.dps(),this.dsc()}renderFight(){this.dph(),this.de(),this.dr(),this.dpt(),this.dpe(),this.dbb(),this.dcab(),this.dfm()}rv(){this.dt("VICTORY!"),this.dvs(),this.dcp()}rdf(){this.dt("DEFEATED"),this.dds(),this.drtl()}dbg(){}dt(t){ctx.fillStyle="#fff",ctx.font=a(24,"bold"),ctx.textAlign="center",ctx.fillText(t,c.width/2,40)}dps(){const t=[`Gold: ${this.p.g}`,`Floor: ${this.p.cf}`,`HP: ${this.p.hp}/${this.p.mh}`];ctx.fillStyle="#ccc",ctx.font=a(16),ctx.textAlign="left",t.forEach((t,s)=>ctx.fillText(t,20,80+25*s))}dph(){const t=c.height-60;if(assets.l){let s=this.cdt>0?assets.s:this.p.hp>=5?assets.h:assets.s;ctx.drawImage(s,15,t,60,60)}const s=t+5;for(let t=0;t<this.p.mh;t++){const i=85+22*t,h=t<this.p.hp;this.dh(i,s,18,h)}ctx.fillStyle="#fff",ctx.font=a(12),ctx.textAlign="left",ctx.fillText(`${this.p.hp}/${this.p.mh}`,85,s+30);const i=t+45;ctx.fillStyle="#2a2a2a",ctx.fillRect(84,i-1,182,14),ctx.fillStyle="#1a1a1a",ctx.fillRect(85,i,180,12);const h=this.p.st/this.p.ms*180;if(h>0){const t=ctx.createLinearGradient(85,i,85,i+12);t.addColorStop(0,"#ff8c42"),t.addColorStop(1,"#ff6b1a"),ctx.fillStyle=t,ctx.fillRect(85,i,h,12)}ctx.fillStyle="#ff8c42",ctx.font=a(11,"bold"),ctx.textAlign="center",ctx.fillText(`${Math.floor(this.p.st)}/${this.p.ms}`,175,i-5)}dh(t,s,i,h){const e=i/2;ctx.save(),ctx.translate(t+e,s+e),ctx.beginPath(),ctx.moveTo(0,.3*e),ctx.bezierCurveTo(.8*-e,.3*-e,.8*-e,.3*e,0,.8*e),ctx.bezierCurveTo(.8*e,.3*e,.8*e,.3*-e,0,.3*e),ctx.closePath(),h&&(ctx.fillStyle="#ff5757",ctx.fill()),ctx.strokeStyle=h?"#cc3333":"#666",ctx.lineWidth=1.5,ctx.stroke(),h||(ctx.fillStyle="#222",ctx.fill()),ctx.restore()}de(){if(!this.gs.ce)return;const t=this.gs.ce,s=c.width/2,i=.4*c.height;this.des(t.archetype,s,i,60);const h=.6*c.width,e=(c.width-h)/2;ctx.fillStyle="#333",ctx.fillRect(e,50,h,8);const l=t.hp/t.maxHp;ctx.fillStyle="#ff5757",ctx.fillRect(e,50,h*l,8),ctx.fillStyle="#fff",ctx.font=a(12,"bold"),ctx.textAlign="center",ctx.fillText(`HP: ${Math.ceil(t.hp)}/${t.maxHp}`,c.width/2,73),ctx.fillStyle="#fff",ctx.font=a(18,"bold"),ctx.textAlign="center";const n=t.archetypeData?.name||"Unknown";ctx.fillText(n,c.width/2,35)}des(t,s,i,h){ctx.save();const e=i+3*Math.sin(.003*Date.now()),c=Date.now();this.ce&&c<this.ce.damageFlashUntil&&(ctx.fillStyle="rgba(255,0,0,0.3)",ctx.beginPath(),ctx.arc(s,e,1.2*h,0,2*Math.PI),ctx.fill());const l=1.2*h;if(this.ei[t]){const i=this.ei[t],h=2*l;ctx.drawImage(i,s-l,e-l,h,h)}else ctx.fillStyle="#2b2b2b",ctx.strokeStyle="#111",ctx.lineWidth=3,ctx.beginPath(),ctx.arc(s,e,l,0,2*Math.PI),ctx.fill(),ctx.stroke();ctx.restore()}dr(){const t=Date.now();this.gs.r.forEach(s=>{if(!s.ia)return;const i=s.gcr(t);if(i<s.tr)return;let h,e;switch(s.t){case constants.RING_TYPES.WHITE:h="#fff",e="rgba(255,255,255,0.3)";break;case constants.RING_TYPES.RED:h="#e34a4a",e="rgba(227,74,74,0.4)";break;default:h="#fff",e="rgba(255,255,255,0.3)"}ctx.strokeStyle=e,ctx.lineWidth=8,ctx.beginPath(),ctx.arc(s.x,s.y,i,0,2*Math.PI),ctx.stroke(),ctx.strokeStyle=h,ctx.lineWidth=3,ctx.beginPath(),ctx.arc(s.x,s.y,i,0,2*Math.PI),ctx.stroke(),ctx.strokeStyle="rgba(255,255,255,0.3)",ctx.lineWidth=1,ctx.beginPath(),ctx.arc(s.x,s.y,i-2,0,2*Math.PI),ctx.stroke(),ctx.strokeStyle="rgba(255,255,255,0.15)",ctx.lineWidth=2,ctx.beginPath(),ctx.arc(s.x,s.y,s.tr,0,2*Math.PI),ctx.stroke();const c=s.st+s.d-t;if(Math.abs(c)<=constants.PARRY_WINDOWS.GOOD){let h;switch(s.gpt(t)){case"perfect":h="#0f0";break;case"good":h="#ff0";break;default:h="#f00"}ctx.fillStyle=h,ctx.globalAlpha=.6,ctx.beginPath(),ctx.arc(s.x,s.y-i-15,4,0,2*Math.PI),ctx.fill(),ctx.globalAlpha=1}})}dfm(){const t=Date.now();this.fm.forEach(s=>{const i=(t-s.startTime)/s.duration,h=Math.max(0,1-i),e=30*i;ctx.save(),ctx.globalAlpha=h,s.text.includes("PERFECT")?(ctx.fillStyle="#0f0",ctx.font=a(18,"bold")):s.text.includes("GOOD")?(ctx.fillStyle="#ff0",ctx.font=a(16,"bold")):s.text.includes("DMG")?(ctx.fillStyle="#ff8800",ctx.font=a(14,"bold")):(ctx.fillStyle="#fff",ctx.font=a(14)),ctx.textAlign="center",ctx.fillText(s.text,s.x,s.y-e),ctx.restore()})}dpt(){this.pt.forEach(t=>t.d(ctx))}dpe(){this.pe.forEach(t=>t.d(ctx))}dmu(){ctx.fillStyle="#fff",ctx.font=a(18),ctx.textAlign="left",ctx.fillText("Meta Upgrades:",20,160);let t=0;Object.entries(constants.META_UPGRADES).forEach(([s,i])=>{const h=this.p.mu[s],e=h>=i.maxLevel,l=this.p.cau(s),n=e?0:i.costs[h],r=190+t;ctx.fillStyle=l&&!e?"rgba(57,168,255,0.1)":"rgba(100,100,100,0.05)",ctx.fillRect(15,r-15,c.width-30,40),ctx.fillStyle=e?"#FFD700":l?"#fff":"#888",ctx.font=a(14,"bold"),ctx.textAlign="left",ctx.fillText(`${i.name} (${h}/${i.maxLevel})`,25,r),ctx.fillStyle="#ccc",ctx.font=a(12),ctx.fillText(i.description,25,r+15),ctx.textAlign="right",e?(ctx.fillStyle="#FFD700",ctx.font=a(12,"bold"),ctx.fillText("MAX",c.width-25,r+8)):(ctx.fillStyle=l?"#39a8ff":"#888",ctx.font=a(14,"bold"),ctx.fillText(`${n}g`,c.width-25,r+8)),t+=45}),ctx.textAlign="left"}dsc(){if(0===this.gs.dc.length)return;const t=Math.max(120,(c.height-200)/2+40);ctx.fillStyle="#fff",ctx.font=a(20),ctx.textAlign="center",ctx.fillText("Choose an Option:",c.width/2,t-50),this.gs.dc.forEach((s,i)=>{const h=t+100*i,e=s.option;ctx.fillStyle="rgba(57,168,255,0.1)",ctx.fillRect(12,h-30,c.width-30+6,85),ctx.strokeStyle="rgba(57,168,255,0.3)",ctx.lineWidth=2,ctx.strokeRect(12,h-30,c.width-30+6,85),ctx.fillStyle="#fff",ctx.font=a(18,"bold"),ctx.textAlign="left",ctx.fillText(`${e.name}`,25,h-8),ctx.font=a(12),ctx.fillStyle="#ccc",ctx.fillText(e.description,25,h+15),ctx.fillStyle="#39a8ff",ctx.font=a(32,"bold"),ctx.textAlign="right",ctx.fillText((i+1).toString(),c.width-15-15,h+10),ctx.fillStyle="#888",ctx.font=a(10),ctx.textAlign="right",ctx.fillText(`Press ${i+1} or Click`,c.width-15-15,h+30)})}dsb(){const t=(c.width-200)/2,s=c.height-100;ctx.fillStyle="#39a8ff",ctx.fillRect(t,s,200,50),ctx.fillStyle="#fff",ctx.font="bold 18px Arial",ctx.textAlign="center",ctx.fillText("Start Run",c.width/2,s+32)}dvs(){ctx.fillStyle="#6ab8ff",ctx.font="18px Arial",ctx.textAlign="center",ctx.fillText("Floor Cleared!",c.width/2,120);const t=[`Perfect Parries: ${this.p.pp}`,`Total Gold: ${this.p.g}`];ctx.fillStyle="#ccc",ctx.font="14px Arial",t.forEach((t,s)=>{ctx.fillText(t,c.width/2,160+25*s)})}dema(){ctx.fillStyle="#FFD700",ctx.font=a(16,"bold"),ctx.textAlign="center",ctx.fillText("üéâ Congratulations! üéâ",c.width/2,120),ctx.fillStyle="#fff",ctx.font=a(14),ctx.fillText("You have completed the main game!",c.width/2,150),ctx.fillText("Endless mode is now unlocked!",c.width/2,175),ctx.fillStyle="#ff8800",ctx.font=a(12),ctx.fillText("The difficulty will now scale infinitely",c.width/2,200),ctx.fillText("How far can you go?",c.width/2,220);const t=[`Perfect Parries: ${this.p.pp}`,`Total Gold: ${this.p.g}`];ctx.fillStyle="#ccc",ctx.font=a(12),t.forEach((t,s)=>{ctx.fillText(t,c.width/2,250+20*s)})}dds(){ctx.fillStyle="#e34a4a",ctx.font="18px Arial",ctx.textAlign="center",ctx.fillText(`Reached Floor ${this.gs.rf||this.p.cf}`,c.width/2,120),ctx.fillStyle="#ccc",ctx.font="14px Arial",ctx.fillText(`Gold Earned: ${this.p.g}`,c.width/2,160),ctx.fillStyle="#FFD700",ctx.font="16px Arial",ctx.fillText(`Best Record: Floor ${this.p.hf}`,c.width/2,190)}dcp(){ctx.fillStyle="#fff",ctx.font="14px Arial",ctx.textAlign="center",ctx.fillText("Tap to continue...",c.width/2,c.height-50)}drtl(){ctx.fillStyle="#fff",ctx.font="14px Arial",ctx.textAlign="center",ctx.fillText("Tap to return to lobby...",c.width/2,c.height-50)}hli(t,s){let i=0;for(const[t,h]of Object.entries(constants.META_UPGRADES)){const h=190+45*i;if(s>=h-15&&s<=h+45-20)return void(this.p.cau(t)&&this.p.bu(t));i++}const h=c.height-100;if(s>=h&&s<=h+50)return this.p.snr(),void this.gs.tt("fight")}hdi(t,s){const i=Math.max(120,(c.height-200)/2+40);this.gs.dc.forEach((t,h)=>{const e=i+100*h;s>=e-30&&s<=e+55&&this.gs.sdc(h)})}hfi(t,s,i){const h=c.width-60-20,e=c.height-60-20;if(t>=h&&t<=h+60&&s>=e&&s<=e+60)return void this.gs.ab();if(this.gs.bm){const i=c.width/2,h=c.height/2;if(Math.sqrt((t-i)**2+(s-h)**2)<=40){const t=Math.ceil(this.gs.p.bd);return this.gs.ce.hp=Math.max(0,this.gs.ce.hp-t),this.cpe(i,h),void(this.gs.ce.hp<=0&&(this.gs.bm=!1,this.gs.hv()))}}this.cpe(t,s);const l=this.gs.hc(t,s,i);if(l&&l.parry){const i=l.parry.timing.toUpperCase()+"!",h=l.damage?`${l.damage} DMG`:"";this.afm(i,t,s),h&&this.afm(h,t,s-20)}}dbb(){const t=60,s=c.width-t-20,i=c.height-t-20,h=this.gs.cub(),e=this.gs.bm;if(ctx.fillStyle=e?"rgba(255,87,87,0.8)":h?"rgba(57,168,255,0.7)":"rgba(100,100,100,0.5)",ctx.fillRect(s,i,t,t),ctx.strokeStyle=e?"#ff5757":h?"#39a8ff":"#666",ctx.lineWidth=3,ctx.strokeRect(s,i,t,t),ctx.fillStyle=e?"#FFD700":h?"#fff":"#999",ctx.font=a(24,"bold"),ctx.textAlign="center",ctx.fillText("‚ö°",s+30,i+30+8),e){const h=this.gs.p.st/this.gs.p.ms;ctx.fillStyle="rgba(106,184,255,0.8)",ctx.fillRect(s+5,i+t-8,50*h,3)}}dcab(){if(!this.gs.bm)return;const t=c.width/2,s=c.height/2,i=Date.now(),h=40*(.8+.2*Math.sin(i/100));ctx.fillStyle="rgba(255,87,87,0.8)",ctx.beginPath(),ctx.arc(t,s,h,0,2*Math.PI),ctx.fill(),ctx.strokeStyle="#ff5757",ctx.lineWidth=3,ctx.stroke(),ctx.fillStyle="#fff",ctx.font="bold 24px Arial",ctx.textAlign="center",ctx.fillText("!",t,s+8),ctx.fillStyle="#fff",ctx.font="12px Arial",ctx.fillText("SPAM!",t,s+h+20)}}function m(t){const s=t-h;h=t,g&&(g.u(s),g.r()),requestAnimationFrame(m)}window.addEventListener("resize",()=>{g&&g.hr()}),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l):l()</script>